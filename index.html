<!DOCTYPE html>
<body id=body>
    <canvas id="gameCanvas" style="height:100%;width:100%">
    <script src="lib/babylon.max.js"></script>
    <script src="lib/babylonjs.loaders.js"></script>
    <script src="lib/babylon.gui.js"></script>
    <!-- TODO: iterate over files in the js dir -->
    <script type="module" src="src/singletons.js"></script>
    <script type="module" src="src/default_settings.js"></script>
    <script type="module" src="src/util.js"></script>
    <script type="module" src="src/graphics.js"></script>
    <script type="module" src="src/player.js"></script>
    <script type="module" src="src/view_state.js"></script>
    <script type="module" src="src/menu.js"></script>
    <script type="module" src="src/settings.js"></script>
    <script type="module" src="src/missions.js"></script>
    <script type="module" src="src/missions_menu.js"></script>
    <script type="module" src="src/landing.js"></script>
    <script type="module" src="src/store.js"></script>
    <script type="module" src="src/shipyard.js"></script>
    <script type="module" src="src/trade.js"></script>
    <script type="module" src="src/system.js"></script>
    <script type="module" src="src/modal.js"></script>
    <script type="module" src="src/damage.js"></script>
    <script type="module" src="src/physics.js"></script>
    <script type="module" src="src/weapon.js"></script>
    <script type="module" src="src/ecs.js"></script>
    <script type="module" src="src/hyperspace.js"></script>
    <script type="module" src="src/ai.js"></script>
    <script type="module" src="src/input.js"></script>
    <script type="module" src="src/map.js"></script>
    <script type="module" src="src/entities.js"></script>
    <script type="module" src="src/collision.js"></script>
    <script type="module" src="src/hud.js"></script>
    <script type="module" src="src/gameplay.js"></script>
    <script type="module" src="src/load.js"></script>
    <script type="module" src="src/main_menu.js"></script>
    <script type="module" src="src/states.js"></script>
    <script type="module" src="src/main.js"></script>
    <script type="application/vertexShader"
            id="starfield_vertex_shader"
    >
precision highp float;

// Attributes
attribute vec3 position;
attribute vec3 normal;

// Uniforms
uniform mat4 world;
uniform mat4 worldViewProjection;

// Varying
varying vec3 vPositionW;
varying vec3 vNormalW;

void main(void) {
    vec4 outPosition = worldViewProjection * vec4(position, 1.0);
    gl_Position = outPosition;
    
    vPositionW = vec3(world * vec4(position, 1.0));
    vNormalW = normalize(vec3(world * vec4(normal, 0.0)));
}
    
</script>
    <script type="application/fragmentShader"
            id="starfield_fragment_shader"
    >
precision highp float;

// Lights
varying vec3 vPositionW;
varying vec3 vNormalW;

// Refs
uniform vec3 cameraPosition;
uniform sampler2D textureSampler;

void main(void) {
    vec3 color = vec3(1., 1., 1.);
    vec3 viewDirectionW = normalize(cameraPosition - vPositionW);

    // Fresnel
	float fresnelTerm = dot(viewDirectionW, vNormalW);
	fresnelTerm = clamp(1.0 - fresnelTerm, 0., 1.);

    gl_FragColor = vec4(color, 1.);
}
</script>
</body>
